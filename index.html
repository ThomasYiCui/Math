<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Math</title>
    </head>
    <style>
        body {
            background-color: rgb(242, 245, 240);
            font-family: arial;
            color: rgb(0, 0, 0);
        }
        .center {
            text-align: CENTER;
        }
        .centerCenter {
            text-align: CENTER;
            margin-top: 5%;
        }
        .startButton {
            margin-left: 40%;
            width: 20%;
            height: 40px;
            margin-top: 40px;
            background-color: rgb(99, 181, 169);
            border-radius: 2px;
            border: none;
            color: rgb(255, 255, 255);
            font-size: 17px;
        }
        .Button {
            margin-left: 4%;
            width: 20%;
            height: 40px;
            background-color: rgb(99, 181, 169);
            border-radius: 2px;
            border: none;
            float: left;
            color: rgb(255, 255, 255);
            font-size: 17px;
        }
        #ques {
            margin-left: 15%;
            width: 70%;
            background-color: rgb(107, 137, 255);
            color: rgb(255, 255, 255);
            border-radius: 5px;
            height: 60px;
            line-height: 60px;
            text-align: CENTER;
        }
        #Correct {
            background-color: rgb(0, 255, 0);
            width: 100%;
            height: 50px;
            position: fixed;
            top: 50%;
            transform: translate(0, -50%);
            opacity: 0%;
            text-align: CENTER;
            color: rgb(14, 140, 0);
            font-size: 40px;
        }
        #backgroundHp {
            margin-left: 5%;
            margin-bottom: 10px;
            width: 40%;
            height: 20px;
            background-color: rgb(212, 212, 212);
            position: absolute;
            text-align: CENTER;
            border-radius: 5px;
        }
        #Hp {
            margin-left: 5%;
            margin-bottom: 10px;
            width: 40%;
            height: 20px;
            position: absolute;
            background-color: rgb(0, 209, 136);
            text-align: CENTER;
            border-radius: 5px;
        }
        #EbackgroundHp {
            margin-left: 50%;
            margin-bottom: 10px;
            width: 40%;
            height: 20px;
            background-color: rgb(212, 212, 212);
            position: absolute;
            text-align: CENTER;
            border-radius: 5px;
        }
        #EHp {
            margin-left: 50%;
            margin-bottom: 10px;
            width: 40%;
            height: 20px;
            position: absolute;
            background-color: rgb(255, 0, 0);
            text-align: CENTER;
            border-radius: 5px;
        }
        @keyframes CorrectAnim {
            0% {
                opacity: 0%;
            }
            25% {
                opacity: 100%;
            }
            100% {
                opacity: 0%;
            }
        }
    </style>
    <body>
        <div class = "scene">
            <h1 class = "center">Math Game</h1>
            <button class = "startButton" onclick = "javascript: changePage(1);">Start</button>
        </div>
        <div class = "scene">
            <h1 class = "center">Upgrade</h1>
            <p class = "center"> Level: <span id = "level">1</span> || Gold: <span id = "gold">0</span></p>
            <button class = "Button" onclick = "upgrade(['damage', 5], 50);">Damage: 50</button>
            <button class = "Button" onclick = "upgrade(['hp', 25], 50);">Health: 50</button>
            <button class = "Button" onclick = "upgrade(['armor', 1], 10);">Armor: 50</button>
            <button class = "startButton" onclick = "javascript: changePage(2);">I am ready!</button>
        </div>
        <div class = "scene">
            <div id = "Correct">Correct</div>
            <div id = "backgroundHp"></div>
            <div id = "Hp">100</div>
            <div id = "EbackgroundHp"></div>
            <div id = "EHp">100</div>
            <br>
            <br>
            <div id = "ques">
                <h3 class = "centerCenter" id = "q"></h3>
            </div>
            <p class = "center">Correct: <span id = "correct">0/0</span></p>
            <p class = "center">Combo: <span id = "combo">0</span></p>
            <p class = "center">Gold: <span id = "gold">0</span></p>
            
            <button class = "Button" onclick = "updateCor(1); play();"><span id = "q1">Q</span></button>
            <button class = "Button" onclick = "updateCor(2); play();"><span id = "q2">Q</span></button>
            <button class = "Button" onclick = "updateCor(3); play();"><span id = "q3">Q</span></button>
            <button class = "Button" onclick = "updateCor(4); play(); "><span id = "q4">Q</span></button>
        </div>
        <script>
        // the round function
        function round(number) {
            return Math.round(number)
        }
        
        // the random function
        function random(min, max) {
            return min + Math.random(0, 1) * (max - min)
        }
        
        // the constrain function
        function constrain(number, min, max) {
            if(number < min) {
                number = min;
            }else if(number > max){
                number = max;
            }
            return number;
        }
        
        // assign varibles
        var scenes = document.getElementsByClassName('scene');
        
        // q & a varibles
        var q = round(random(0, 3));
        var a = [];
        var cor = 0;
        var incor = 0;
        var rnCor = 0;
        var diff = 1000;
        var combo = 0;
        var eCombo = 0;
        
        // enemys, player, and level stats
        var hp = 100;
        document.getElementById("Hp").innerHTML = hp;
        var MaxHp = 100;
        document.getElementById("Hp").style.width = hp/(MaxHp/40) + "%";
        var damage = 10;
        var eHp = 100;
        document.getElementById("EHp").style.width = eHp/(MaxHp/40) + "%";
        var eMaxHp = 100;
        document.getElementById("EHp").innerHTML = eHp;
        var eDamage = 10;
        var level = 1;
        document.getElementById("level").innerHTML = level;
        var gold = 0;
        document.getElementById("gold").innerHTML = gold;
        var eGold = 0;
        var armor = 0;
        var eArmor = 0;
        
        // difference function
        function difference(number, max) {
            if(random(0, 100) < 50) {
                number -= round(random(1, max));
            }else {
                number += round(random(1, max));
            }
            return number;
        }
        
        // play function
        function play() {
            q = round(random(0, 3));
            if(q === 0) {
                a = [round(random(10 * (diff/1000), 20 * diff/1000)), round(random(10 * (diff/1000), 20 * diff/1000))];
                document.getElementById("q").innerHTML = "What is " + a[0] + " + " + a[1];
                var choosen = random(0, 100);
                document.getElementById("q1").innerHTML = difference(a[0] + a[1], 10);
                document.getElementById("q2").innerHTML = difference(a[0] + a[1], 10);
                document.getElementById("q3").innerHTML = difference(a[0] + a[1], 10);
                document.getElementById("q4").innerHTML = difference(a[0] + a[1], 10);
                if(choosen < 25) {
                    document.getElementById("q1").innerHTML = a[0] + a[1];
                    rnCor = 1;
                }else if(choosen < 50) {
                    document.getElementById("q2").innerHTML = a[0] + a[1];
                    rnCor = 2;
                }else if(choosen < 75) {
                    document.getElementById("q3").innerHTML = a[0] + a[1];
                    rnCor = 3;
                }else {
                    document.getElementById("q4").innerHTML = a[0] + a[1];
                    rnCor = 4;
                }
            }else if(q === 1) {
                // what the answer and questions will pick from
                a = [round(random(2 * (diff/1000), 5 * diff/1000)), round(random(2 * (diff/1000), 5 * diff/1000))];
                
                // change the questions to match what a choose
                document.getElementById("q").innerHTML = "What is " + a[0] + " x " + a[1];
                
                // the varible for who will have the answer
                var choosen = random(0, 100);
                
                // change the q's to somewhere near the answer
                document.getElementById("q1").innerHTML = difference(a[0] * a[1], 10);
                document.getElementById("q2").innerHTML = difference(a[0] * a[1], 10);
                document.getElementById("q3").innerHTML = difference(a[0] * a[1], 10);
                document.getElementById("q4").innerHTML = difference(a[0] * a[1], 10);
                if(choosen < 25) {
                    // if q1 has the answer
                    document.getElementById("q1").innerHTML = a[0] * a[1];
                    rnCor = 1;
                }else if(choosen < 50) {
                    // if q2 has the answer
                    document.getElementById("q2").innerHTML = a[0] * a[1];
                    rnCor = 2;
                }else if(choosen < 75) {
                    // if q3 has the answet
                    document.getElementById("q3").innerHTML = a[0] * a[1];
                    rnCor = 3;
                }else {
                    // if q4 has the answer
                    document.getElementById("q4").innerHTML = a[0] * a[1];
                    rnCor = 4;
                }
            }else if(q === 2) {
                // different a for the question
                a = [round(random(2 * (diff/1000), 4 * diff/1000))];
                a.push(a[0] * round(random(2, diff/1000)))
                
                // make the question
                document.getElementById("q").innerHTML = "What is " + a[1] + " / " + a[0];
                
                // make a varible to see which q will have the answer
                var choosen = random(0, 100);
                
                // set all the q's to random varibles between the answer
                document.getElementById("q1").innerHTML = difference(a[1] / a[0], 10);
                document.getElementById("q2").innerHTML = difference(a[1] / a[0], 10);
                document.getElementById("q3").innerHTML = difference(a[1] / a[0], 10);
                document.getElementById("q4").innerHTML = difference(a[1] / a[0], 10);
                
                // see which q has the answer
                if(choosen < 25) {
                    // if q1 has the answer
                    document.getElementById("q1").innerHTML = a[1] / a[0];
                    rnCor = 1;
                }else if(choosen < 50) {
                    // if q2 has the answer
                    document.getElementById("q2").innerHTML = a[1] / a[0];
                    rnCor = 2;
                }else if(choosen < 75) {
                    // id q3 has the answer
                    document.getElementById("q3").innerHTML = a[1] / a[0];
                    rnCor = 3;
                }else {
                    // if q4 has the answer
                    document.getElementById("q4").innerHTML = a[1] / a[0];
                    rnCor = 4;
                }
            }
            // if the enemys has died
            if(eHp <= 0) {
                hp = MaxHp;
                eHp = eMaxHp;
                level += 1;
                document.getElementById("level").innerHTML = level;
                gold+=100;
                changePage(1);
                eGold+=100;
                document.getElementById("Correct").style.animation = 'none';
                document.getElementById("Correct").offsetHeight; /* trigger reflow */
                document.getElementById("Correct").style.animation = null; 
            }else if(hp <= 0) {
                hp = MaxHp;
                eHp = eMaxHp;
            }
            if(eGold > 0) {
                choose = round(random(0, 100));
                if(choose < 50) {
                    eMaxHp+=25;
                    eGold-=50;
                    eHp = eMaxHp;
                    document.getElementById("EHp").innerHTML = eHp;
                    document.getElementById("EHp").style.width = eHp/(eMaxHp/40) + "%";
                }else if(choose <= 100) {
                    eDamage+=5;
                    eGold-=50;
                }
            }if(q === 3) {
                a = [round(random(10 * (diff/1000), 20 * diff/1000)), round(random(5 * (diff/1000), 10 * diff/1000))];
                document.getElementById("q").innerHTML = "What is " + a[0] + " - " + a[1];
                var choosen = random(0, 100);
                document.getElementById("q1").innerHTML = difference(a[0] - a[1], 10);
                document.getElementById("q2").innerHTML = difference(a[0] - a[1], 10);
                document.getElementById("q3").innerHTML = difference(a[0] - a[1], 10);
                document.getElementById("q4").innerHTML = difference(a[0] - a[1], 10);
                if(choosen < 25) {
                    document.getElementById("q1").innerHTML = a[0] - a[1];
                    rnCor = 1;
                }else if(choosen < 50) {
                    document.getElementById("q2").innerHTML = a[0] - a[1];
                    rnCor = 2;
                }else if(choosen < 75) {
                    document.getElementById("q3").innerHTML = a[0] - a[1];
                    rnCor = 3;
                }else {
                    document.getElementById("q4").innerHTML = a[0] - a[1];
                    rnCor = 4;
                }
            }
            
            // update the gold value
            document.getElementById("gold").innerHTML = gold;
        }
        
        // update cor function
        function updateCor(button) {
            // check if correct
            if(button === rnCor) {
                // do things if correct
                cor+=1;
                diff+=100;
                combo+=1;
                eHp-=constrain(damage + round(combo/3) + round(random(0, 5)) - eArmor, 0, Infinity);
                document.getElementById("Correct").style.animation = 'none';
                document.getElementById("Correct").offsetHeight; /* trigger reflow */
                document.getElementById("Correct").style.animation = null; 
                document.getElementById("Correct").style.animation = 'CorrectAnim 2s';
            }else {
                // do things is not
                incor+=1;
                if(diff > 500) {
                    diff-=50;
                }
                combo = 0;
            }
            
            // do a random to see if the player takes damage
            if(round(random(0, 100)) < ((100/(cor + incor)) * cor) + round(random(-80, 20))) {
                eCombo+=1;
                hp-=constrain(eDamage + round(eCombo/3) + round(random(0, 5)) - armor, 0, Infinity);
            }else {
                eCombo = 0;
            }
            
            // redo the functions
            play();
            
            // change the elements to match the varibles
            document.getElementById("correct").innerHTML = cor + " / " + incor;
            document.getElementById("Hp").innerHTML = hp;
            document.getElementById("Hp").style.width = hp/(MaxHp/40) + "%";
            document.getElementById("EHp").innerHTML = eHp;
            document.getElementById("EHp").style.width = eHp/(eMaxHp/40) + "%";
            document.getElementById("combo").innerHTML = combo;
        }
        
        // upgrade function
        function upgrade(type, cost) {
            // if your gold is more then the cost
            if(gold >= cost) {
                // if the upgrade is damage
                if(type[0] === "damage") {
                    damage+=type[1];
                    gold-=cost;
                // if the upgrade is hp
                }else if(type[0] === "hp") {
                    MaxHp+=type[1];
                    gold-=cost;
                    hp = MaxHp;
                    document.getElementById("Hp").innerHTML = hp;
                    document.getElementById("Hp").style.width = hp/(MaxHp/40) + "%";
                }else if(type[0] === "armor") {
                    armor+=type[1];
                    gold-=cost;
                }
                // update the gold
                document.getElementById("gold").innerHTML = gold;
            }
        }
        
        // change play function
        function changePage(index) {
            window.scroll(0, 0);
            for (var i = 0; i < scenes.length ; i++) {
                scenes[i].style.display = 'none';
            }
            scenes[index].style.display = 'block';
        };
        
        // change the page
        changePage(0);
        
        // load the game
        play();

    </script>
    </body>
</html>
