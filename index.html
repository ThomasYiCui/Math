<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>New webpage</title>
        <style>
            body {
                position: fixed;
            }
            #canvi {
                margin-left: -10px;
                margin-top: -10px;
            }
        </style>
    </head>
    <body>
        <canvas id="canvi"></canvas>
        <script>
            // makes it more like javascript
            var canvas = document.getElementById("canvi");
            var ctx = canvas.getContext("2d");
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            var mouseX = 0;
            var mouseY = 0;
            var clicked = false
            var keys = [];
            canvas.addEventListener("mousemove", function(e) { 
                var cRect = canvas.getBoundingClientRect();
                mouseX = Math.round(e.clientX - cRect.left);
                mouseY = Math.round(e.clientY - cRect.top);
            });
            canvas.addEventListener("mousedown", function(e) {
                dragged = true;
            }, false);
            canvas.addEventListener("mouseup", function(e) {
                if(dragged === true) {
                    clicked = true;
                    dragged = false;
                }
            })
            window.addEventListener("keydown", keysPressed, false);
            window.addEventListener("keyup", keysReleased, false);
            function keysPressed(e) {
                // store an entry for every key pressed
                keys[e.keyCode] = true;
             
                e.preventDefault();
            }
             
            function keysReleased(e) {
                // mark keys that were released
                keys[e.keyCode] = false;
            }
            function cos(r) {
                return Math.cos(r);
            }
            function sin(r) {
                return Math.sin(r);
            }
            function atan2(y, x) {
                return Math.atan2(y, x)
            }
            function round(num) {
                return Math.round(num);
            }
            function random(min, max) {
                return min + Math.random(0, 1) * (max - min);
            }
            function dist(x, y, x2, y2) {
                var a = x - x2;
                var b = y - y2;
                return Math.sqrt(a * a + b * b);
            }
            function fill(r, g, b) {
                ctx.fillStyle = "rgb(" + r + ", " + g + ", " + b + ")";
            }
            function stroke(r, g, b) {
                ctx.strokeStyle = "rgb(" + r + ", " + g + ", " + b + ")";
            }
            function rect(x, y, w, h) {
                ctx.fillRect(x, y, w, h);
            }
            function strokeWeight(s) {
                ctx.lineWidth = s;
            }
            function eRect(x, y, w, h, col) {
                ctx.beginPath();
                stroke(col[0], col[1], col[2]);
                ctx.rect(x, y, w, h);
                ctx.stroke();
            }
            function start() {
                var myVar = setInterval(draw, 5);
            }
            function text(txt, x, y, size) {
                ctx.font = size + "px Arial";
                ctx.fillText(txt, x, y);
            }
            function textAlign(align) {
                ctx.textAlign = align;
            }
            function lerp(a, b, t) {
                return a + (b - a) * t;
            }
            function dist2(a, b, d) {
                return (a - b) > -d && (a - b) < d;
            }
            function ellipse(x, y, radiusX, radiusY, rotation) {
                ctx.beginPath();
                ctx.ellipse(x, y, radiusX, radiusY, rotation, 0, 2 * Math.PI);
                ctx.fill();
            }
            function eEllipse(x, y, radiusX, radiusY, rotation) {
                ctx.beginPath();
                ctx.ellipse(x, y, radiusX, radiusY, rotation, 0, 2 * Math.PI);
                ctx.stroke();
            }
            function constrain(num, m, ma) {
                if(num < m) {
                    num = m;
                } else if(num > ma) {
                    num = ma;
                }
                return num;
            }
             
        </script>
        <script>
            // game
            var scene = "menu";
            function button(x, y, w, h, t, txt) {
                strokeWeight(3)
                eRect(x, y, w, h, (0, 0, 0))
                textAlign("center")
                text(txt[0], x + w/2, y + h/2 + txt[1]/4, txt[1])
                if(mouseX > x && mouseY > y && mouseX < x + w && mouseY < y + h && clicked) {
                    t();
                }
            }
            function cButton(x, y, d, t, txt) {
                eEllipse(x, y, d, d, 0)
                textAlign("center")
                text(txt[0], x, y + txt[1]/4, txt[1])
                if(dist(x, y, mouseX, mouseY) < d/2 && clicked) {
                    t();
                }
            }
            var game = {
                q1: 0,
                q2: 0,
                s: "-",
                b1: 0,
                b2: 0, 
                b3: 0,
                b4: 0,
                coorect: 0,
                diff: 10,
                type: "Sub",
            };
            var player = {
                maxHp: 100,
                hp: 100,
                damage: 10,
                armor: 0,
                reflect: 0,
                exp: 0,
                lvl: 0,
            };
            var cam = {
                y: 0,
            };
            var enemy = {
                maxHp: 100,
                hp: 100,
                damage: 10,
                armor: 0,
                reflect: 0,
                name: "Thomas",
            }
            function d(difference) {
                var d = difference;
                if(random(0, 1) < 0.5) {
                    difference = round(random(-d, -1));
                } else {
                    difference = round(random(d, 1));
                }
                return difference;
            }
            function getQuestion(t) {
                var choose = round(random(0, 100));
                if(game.type === "Add") {
                    game.q1 = round(random(game.diff, game.diff * 1.5));
                    game.q2 = round(random(game.diff, game.diff * 1.5));
                    if(choose <= 25) {
                        game.correct = 1;
                        game.b1 = game.q1 + game.q2;
                        game.b2 = game.q1 + game.q2 - d(10);
                        game.b3 = game.q1 + game.q2 - d(10);
                        game.b4 = game.q1 + game.q2 - d(10);
                    } else if(choose <= 50) {
                        game.correct = 2;
                        game.b2 = game.q1 + game.q2;
                        game.b1 = game.q1 + game.q2 - d(10);
                        game.b3 = game.q1 + game.q2 - d(10);
                        game.b4 = game.q1 + game.q2 - d(10);
                    } else if(choose <= 75) {
                        game.correct = 3;
                        game.b3 = game.q1 + game.q2;
                        game.b2 = game.q1 + game.q2 - d(10);
                        game.b1 = game.q1 + game.q2 - d(10);
                        game.b4 = game.q1 + game.q2 - d(10);
                    } else if(choose <= 100) {
                        game.correct = 4;
                        game.b4 = game.q1 + game.q2;
                        game.b2 = game.q1 + game.q2 - d(10);
                        game.b3 = game.q1 + game.q2 - d(10);
                        game.b1 = game.q1 + game.q2 - d(10);
                    }
                } else if(game.type === "Sub") {
                    game.q1 = round(random(game.diff * 2, game.diff * 4));
                    game.q2 = round(random(game.diff * 1.5, game.diff * 1.5));
                    if(choose <= 25) {
                        game.correct = 1;
                        game.b1 = game.q1 - game.q2;
                        game.b2 = game.q1 - game.q2 - d(10);
                        game.b3 = game.q1 - game.q2 - d(10);
                        game.b4 = game.q1 - game.q2 - d(10);
                    } else if(choose <= 50) {
                        game.correct = 2;
                        game.b2 = game.q1 - game.q2;
                        game.b1 = game.q1 - game.q2 - d(10);
                        game.b3 = game.q1 - game.q2 - d(10);
                        game.b4 = game.q1 - game.q2 - d(10);
                    } else if(choose <= 75) {
                        game.correct = 3;
                        game.b3 = game.q1 - game.q2;
                        game.b2 = game.q1 - game.q2 - d(10);
                        game.b1 = game.q1 - game.q2 - d(10);
                        game.b4 = game.q1 - game.q2 - d(10);
                    } else if(choose <= 100) {
                        game.correct = 4;
                        game.b4 = game.q1 - game.q2;
                        game.b2 = game.q1 - game.q2 - d(10);
                        game.b3 = game.q1 - game.q2 - d(10);
                        game.b1 = game.q1 - game.q2 - d(10);
                    }
                } else if(game.type === "Mul") {
                    game.q1 = round(random(game.diff * 0.5, game.diff));
                    game.q2 = round(random(game.diff * 0.5, game.diff));
                    if(choose <= 25) {
                        game.correct = 1;
                        game.b1 = game.q1 * game.q2;
                        game.b2 = game.q1 * game.q2 - d(10);
                        game.b3 = game.q1 * game.q2 - d(10);
                        game.b4 = game.q1 * game.q2 - d(10);
                    } else if(choose <= 50) {
                        game.correct = 2;
                        game.b2 = game.q1 * game.q2;
                        game.b1 = game.q1 * game.q2 - d(10);
                        game.b3 = game.q1 * game.q2 - d(10);
                        game.b4 = game.q1 * game.q2 - d(10);
                    } else if(choose <= 75) {
                        game.correct = 3;
                        game.b3 = game.q1 * game.q2;
                        game.b2 = game.q1 * game.q2 - d(10);
                        game.b1 = game.q1 * game.q2 - d(10);
                        game.b4 = game.q1 * game.q2 - d(10);
                    } else if(choose <= 100) {
                        game.correct = 4;
                        game.b4 = game.q1 * game.q2;
                        game.b2 = game.q1 * game.q2 - d(10);
                        game.b3 = game.q1 * game.q2 - d(10);
                        game.b1 = game.q1 * game.q2 - d(10);
                    }
                } else if(game.type === "Div") {
                    game.q2 = round(random(game.diff * 0.5, game.diff));
                    game.q1 = game.q2 * round(random(game.diff/10, game.diff/5));
                    if(choose <= 25) {
                        game.correct = 1;
                        game.b1 = game.q1 / game.q2;
                        game.b2 = game.q1 / game.q2 - d(10);
                        game.b3 = game.q1 / game.q2 - d(10);
                        game.b4 = game.q1 / game.q2 - d(10);
                    } else if(choose <= 50) {
                        game.correct = 2;
                        game.b2 = game.q1 / game.q2;
                        game.b1 = game.q1 / game.q2 - d(10);
                        game.b3 = game.q1 / game.q2 - d(10);
                        game.b4 = game.q1 / game.q2 - d(10);
                    } else if(choose <= 75) {
                        game.correct = 3;
                        game.b3 = game.q1 / game.q2;
                        game.b2 = game.q1 / game.q2 - d(10);
                        game.b1 = game.q1 / game.q2 - d(10);
                        game.b4 = game.q1 / game.q2 - d(10);
                    } else if(choose <= 100) {
                        game.correct = 4;
                        game.b4 = game.q1 / game.q2;
                        game.b2 = game.q1 / game.q2 - d(10);
                        game.b3 = game.q1 / game.q2 - d(10);
                        game.b1 = game.q1 / game.q2 - d(10);
                    }
                }
                if(round(random(0, 100)) < 80 && t !== true) {
                    player.hp-=enemy.damage - player.armor;
                }
            }
            function bg() {
                fill(0, 150, 255);
                rect(0, 0, canvas.width, canvas.height);
                fill(0, 150, 0);
                        ellipse(canvas.width/4, canvas.height - canvas.height/24, canvas.width/2, canvas.height/9, 0)
                        ellipse(canvas.width - canvas.width/6, canvas.height - canvas.height/24, canvas.width/2, canvas.height/5, 0)
            }
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                switch(scene) {
                    case "menu":
                        bg()
                        fill(0, 0, 0);
                        text("Math Game", canvas.width/2, canvas.height/2 - 25, 60)
                        button(canvas.width/2 - 50, canvas.height/2 + 25, 100, 50, function() {
                            scene = "levels";
                            getQuestion(true);
                        }, ["Play", 30]);
                    break;
                    case "levels":
                        bg();
                        fill(0, 0, 0);
                        for(var y = canvas.height/50; y > -100; y-=1) {
                            if(-cam.y + canvas.height + 50 > y * 50) {
                                cButton(canvas.width/2 + cos(y * 16.3) * canvas.width/4, -25 + y * 50 + cam.y, 20, function() {
                                    scene = "play";
                                    if(Math.floor(y) % 4 === 0) {
                                        game.s = "+";
                                        game.type = "Add";
                                    } else if(Math.floor(y) % 4 === 1) {
                                        game.s = "-";
                                        game.type = "Sub";;
                                    } else if(Math.floor(y) % 4 === 2) {
                                        game.s = "x";
                                        game.type = "Mul";;
                                    } else if(Math.floor(y) % 4 === 3) {
                                        game.s = "/";
                                        game.type = "Div";;
                                    }
                                    getQuestion(true);
                                }, [Math.floor(-y + Math.floor(canvas.height/50 + 1)), 30]);
                            }
                        }
                        if(keys[87] || keys[38]) {
                            cam.y+=1;
                        }
                        if(keys[83] || keys[40]) {
                            cam.y-=1;
                            cam.y = constrain(cam.y, 0, Infinity);
                        }
                    break;
                    case "play":
                        bg();
                        fill(100, 100, 100);
                        rect(10, 30, 200, 20);
                        rect(10 + (canvas.width - 220), 30, 200, 20);
                        fill(0, 255, 0);
                        rect(10, 30, (200/player.maxHp) * player.hp, 20);
                        fill(255, 0, 0);
                        rect(10 + (canvas.width - 220), 30, (200/enemy.maxHp) * enemy.hp, 20);
                        fill(0, 0, 0);
                        text("You | Level: " + (player.lvl + 1), 100, 25, 20);
                        text(enemy.name + " | Level: " + (player.lvl + 1), 25 + (canvas.width - 120), 25, 20)
                        text(enemy.hp, 100 + (canvas.width - 200), 47.5, 20)
                        text(player.hp, 100, 47.5, 20)
                        text("What is " + game.q1 + " " + game.s + " " + game.q2, canvas.width/2, canvas.height/2 - 75, 30)
                        button(canvas.width/8 + canvas.width/5 * 0, canvas.height/2 + 25, canvas.width/6, 50, function() {
                            if(game.correct === 1) {
                                getQuestion();
                                enemy.hp-=player.damage - enemy.armor;
                                game.diff+=1;
                            } else {
                                getQuestion();
                                game.diff-=0.5;
                                game.diff = constrain(game.diff, 5, Infinity)
                            }
                        }, [game.b1, 30]);
                        button(canvas.width/8 + canvas.width/5 * 1, canvas.height/2 + 25, canvas.width/6, 50, function() {
                            if(game.correct === 2) {
                                getQuestion();
                                enemy.hp-=player.damage - enemy.armor;
                                game.diff+=1;
                            } else {
                                getQuestion();
                                game.diff-=0.5;
                                game.diff = constrain(game.diff, 5, Infinity)
                            }
                        }, [game.b2, 30]);
                        button(canvas.width/8 + canvas.width/5 * 2, canvas.height/2 + 25, canvas.width/6, 50, function() {
                            if(game.correct === 3) {
                                getQuestion();
                                enemy.hp-=player.damage - enemy.armor;
                                game.diff+=1;
                            } else {
                                getQuestion();
                                game.diff-=0.5;
                                game.diff = constrain(game.diff, 5, Infinity)
                            }
                        }, [game.b3, 30]);
                        button(canvas.width/8 + canvas.width/5 * 3, canvas.height/2 + 25, canvas.width/6, 50, function() {
                            if(game.correct === 4) {
                                getQuestion();
                                enemy.hp-=player.damage - enemy.armor;
                                game.diff+=1;
                            } else {
                                getQuestion();
                                game.diff-=0.5;
                                game.diff = constrain(game.diff, 5, Infinity)
                            }
                        }, [game.b4, 30]);
                        if(enemy.hp <= 0) {
                            player.hp = player.maxHp;
                            enemy.hp = enemy.maxHp;
                            scene = "levels";
                            player.exp+=10;
                            player.lvl = Math.floor(player.exp/((player.lvl * player.lvl) * 5));
                            player.maxHp = 100 + (player.lvl * player.lvl) * 100;
                            player.hp = 100 + (player.lvl * player.lvl) * 100;
                            player.damage = 10 + (player.lvl * player.lvl) * 10;
                            enemy.damage = 10 + (player.lvl * player.lvl) * 10;
                            enemy.maxHp = 100 + (player.lvl * player.lvl) * 100;
                            enemy.hp = 100 + (player.lvl * player.lvl) * 100;
                        } else if(player.hp <= 0) {
                            player.hp = player.maxHp;
                            enemy.hp = enemy.maxHp;
                            scene = "levels"
                        }
                    break;
                }
                clicked = false;
            }
            draw();
            start();
            clicked = false;
        </script>
    </body>
</html>
